{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import axios from\"axios\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[photos,setPhotos]=useState([]);const[selectedFiles,setSelectedFiles]=useState([]);const[isUploading,setIsUploading]=useState(false);const S3_BUCKET_URL=\"https://engagement-party-photo.s3.amazonaws.com/\";const API_BASE_URL=process.env.REACT_APP_API_BASE_URL;// Dynamically set via Amplify\n// Fetch uploaded photos (list from S3 bucket)\nuseEffect(()=>{async function fetchPhotos(){try{// Use API_BASE_URL for fetching photos\nconst response=await axios.get(\"\".concat(API_BASE_URL,\"/photos\"));setPhotos(response.data);}catch(error){console.error(\"Error fetching photos:\",error);}}fetchPhotos();},[API_BASE_URL]);// Handle file selection\nconst handleFileChange=event=>{setSelectedFiles([...event.target.files]);};// Upload the selected files to S3\nconst handleUpload=async()=>{if(selectedFiles.length===0){alert(\"Please select photos to upload!\");return;}setIsUploading(true);try{const uploadedPhotos=[];for(const file of selectedFiles){// Get signed URL from backend using API_BASE_URL\nconst response=await axios.post(\"\".concat(API_BASE_URL,\"/upload-url\"),{filename:file.name,filetype:file.type});const{uploadUrl,fileUrl}=response.data;// Upload file to S3\nawait axios.put(uploadUrl,file,{headers:{\"Content-Type\":file.type}});uploadedPhotos.push(fileUrl);}// Update photo gallery\nsetPhotos(prevPhotos=>[...prevPhotos,...uploadedPhotos]);alert(\"Photos uploaded successfully!\");}catch(error){console.error(\"Error uploading photos:\",error);if(error.response){alert(\"Upload failed: \".concat(error.response.data.message||error.response.data||\"Server error\"));}else if(error.request){alert(\"Upload failed: No response received from the server.\");}else{alert(\"Upload failed: \".concat(error.message));}}setIsUploading(false);setSelectedFiles([]);};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50 p-4\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-center mb-4\",children:\"Engagement Party Photos\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-md mx-auto bg-white rounded-lg shadow p-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold mb-2\",children:\"Upload Your Photos\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handleFileChange,multiple:true,className:\"block w-full border p-2 mb-2 rounded\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleUpload,disabled:isUploading,className:\"w-full bg-blue-500 text-white py-2 rounded \".concat(isUploading?\"opacity-50 cursor-not-allowed\":\"\"),children:isUploading?\"Uploading...\":\"Upload Photos\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold text-center mb-4\",children:\"Photo Gallery\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 md:grid-cols-3 gap-4\",children:photos.map((photo,index)=>/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(S3_BUCKET_URL).concat(photo),alt:\"Uploaded\",className:\"rounded shadow\"},index))})]})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","App","photos","setPhotos","selectedFiles","setSelectedFiles","isUploading","setIsUploading","S3_BUCKET_URL","API_BASE_URL","process","env","REACT_APP_API_BASE_URL","fetchPhotos","response","get","concat","data","error","console","handleFileChange","event","target","files","handleUpload","length","alert","uploadedPhotos","file","post","filename","name","filetype","type","uploadUrl","fileUrl","put","headers","push","prevPhotos","message","request","className","children","accept","onChange","multiple","onClick","disabled","map","photo","index","src","alt"],"sources":["/Users/tylerc26/Desktop/engagement-photo-app/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\n\nfunction App() {\n  const [photos, setPhotos] = useState([]);\n  const [selectedFiles, setSelectedFiles] = useState([]);\n  const [isUploading, setIsUploading] = useState(false);\n\n  const S3_BUCKET_URL = \"https://engagement-party-photo.s3.amazonaws.com/\";\n  const API_BASE_URL = process.env.REACT_APP_API_BASE_URL; // Dynamically set via Amplify\n\n  // Fetch uploaded photos (list from S3 bucket)\n  useEffect(() => {\n    async function fetchPhotos() {\n      try {\n        // Use API_BASE_URL for fetching photos\n        const response = await axios.get(`${API_BASE_URL}/photos`);\n        setPhotos(response.data);\n      } catch (error) {\n        console.error(\"Error fetching photos:\", error);\n      }\n    }\n    fetchPhotos();\n  }, [API_BASE_URL]);\n\n  // Handle file selection\n  const handleFileChange = (event) => {\n    setSelectedFiles([...event.target.files]);\n  };\n\n  // Upload the selected files to S3\n  const handleUpload = async () => {\n    if (selectedFiles.length === 0) {\n      alert(\"Please select photos to upload!\");\n      return;\n    }\n\n    setIsUploading(true);\n\n    try {\n      const uploadedPhotos = [];\n\n      for (const file of selectedFiles) {\n        // Get signed URL from backend using API_BASE_URL\n        const response = await axios.post(`${API_BASE_URL}/upload-url`, {\n          filename: file.name,\n          filetype: file.type,\n        });\n\n        const { uploadUrl, fileUrl } = response.data;\n\n        // Upload file to S3\n        await axios.put(uploadUrl, file, {\n          headers: {\n            \"Content-Type\": file.type,\n          },\n        });\n\n        uploadedPhotos.push(fileUrl);\n      }\n\n      // Update photo gallery\n      setPhotos((prevPhotos) => [...prevPhotos, ...uploadedPhotos]);\n      alert(\"Photos uploaded successfully!\");\n    } catch (error) {\n      console.error(\"Error uploading photos:\", error);\n\n      if (error.response) {\n        alert(`Upload failed: ${error.response.data.message || error.response.data || \"Server error\"}`);\n      } else if (error.request) {\n        alert(\"Upload failed: No response received from the server.\");\n      } else {\n        alert(`Upload failed: ${error.message}`);\n      }\n    }\n\n    setIsUploading(false);\n    setSelectedFiles([]);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-4\">\n      <h1 className=\"text-3xl font-bold text-center mb-4\">Engagement Party Photos</h1>\n\n      {/* Photo Upload Section */}\n      <div className=\"max-w-md mx-auto bg-white rounded-lg shadow p-4\">\n        <h2 className=\"text-xl font-semibold mb-2\">Upload Your Photos</h2>\n        <input\n          type=\"file\"\n          accept=\"image/*\"\n          onChange={handleFileChange}\n          multiple\n          className=\"block w-full border p-2 mb-2 rounded\"\n        />\n        <button\n          onClick={handleUpload}\n          disabled={isUploading}\n          className={`w-full bg-blue-500 text-white py-2 rounded ${\n            isUploading ? \"opacity-50 cursor-not-allowed\" : \"\"\n          }`}\n        >\n          {isUploading ? \"Uploading...\" : \"Upload Photos\"}\n        </button>\n      </div>\n\n      {/* Photo Gallery Section */}\n      <div className=\"mt-8\">\n        <h2 className=\"text-2xl font-semibold text-center mb-4\">Photo Gallery</h2>\n        <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\n          {photos.map((photo, index) => (\n            <img\n              key={index}\n              src={`${S3_BUCKET_URL}${photo}`}\n              alt=\"Uploaded\"\n              className=\"rounded shadow\"\n            />\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE1B,QAAS,CAAAC,GAAGA,CAAA,CAAG,CACb,KAAM,CAACC,MAAM,CAAEC,SAAS,CAAC,CAAGT,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAACU,aAAa,CAAEC,gBAAgB,CAAC,CAAGX,QAAQ,CAAC,EAAE,CAAC,CACtD,KAAM,CAACY,WAAW,CAAEC,cAAc,CAAC,CAAGb,QAAQ,CAAC,KAAK,CAAC,CAErD,KAAM,CAAAc,aAAa,CAAG,kDAAkD,CACxE,KAAM,CAAAC,YAAY,CAAGC,OAAO,CAACC,GAAG,CAACC,sBAAsB,CAAE;AAEzD;AACAjB,SAAS,CAAC,IAAM,CACd,cAAe,CAAAkB,WAAWA,CAAA,CAAG,CAC3B,GAAI,CACF;AACA,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAlB,KAAK,CAACmB,GAAG,IAAAC,MAAA,CAAIP,YAAY,WAAS,CAAC,CAC1DN,SAAS,CAACW,QAAQ,CAACG,IAAI,CAAC,CAC1B,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,CAAEA,KAAK,CAAC,CAChD,CACF,CACAL,WAAW,CAAC,CAAC,CACf,CAAC,CAAE,CAACJ,YAAY,CAAC,CAAC,CAElB;AACA,KAAM,CAAAW,gBAAgB,CAAIC,KAAK,EAAK,CAClChB,gBAAgB,CAAC,CAAC,GAAGgB,KAAK,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,CAC3C,CAAC,CAED;AACA,KAAM,CAAAC,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAIpB,aAAa,CAACqB,MAAM,GAAK,CAAC,CAAE,CAC9BC,KAAK,CAAC,iCAAiC,CAAC,CACxC,OACF,CAEAnB,cAAc,CAAC,IAAI,CAAC,CAEpB,GAAI,CACF,KAAM,CAAAoB,cAAc,CAAG,EAAE,CAEzB,IAAK,KAAM,CAAAC,IAAI,GAAI,CAAAxB,aAAa,CAAE,CAChC;AACA,KAAM,CAAAU,QAAQ,CAAG,KAAM,CAAAlB,KAAK,CAACiC,IAAI,IAAAb,MAAA,CAAIP,YAAY,gBAAe,CAC9DqB,QAAQ,CAAEF,IAAI,CAACG,IAAI,CACnBC,QAAQ,CAAEJ,IAAI,CAACK,IACjB,CAAC,CAAC,CAEF,KAAM,CAAEC,SAAS,CAAEC,OAAQ,CAAC,CAAGrB,QAAQ,CAACG,IAAI,CAE5C;AACA,KAAM,CAAArB,KAAK,CAACwC,GAAG,CAACF,SAAS,CAAEN,IAAI,CAAE,CAC/BS,OAAO,CAAE,CACP,cAAc,CAAET,IAAI,CAACK,IACvB,CACF,CAAC,CAAC,CAEFN,cAAc,CAACW,IAAI,CAACH,OAAO,CAAC,CAC9B,CAEA;AACAhC,SAAS,CAAEoC,UAAU,EAAK,CAAC,GAAGA,UAAU,CAAE,GAAGZ,cAAc,CAAC,CAAC,CAC7DD,KAAK,CAAC,+BAA+B,CAAC,CACxC,CAAE,MAAOR,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAE/C,GAAIA,KAAK,CAACJ,QAAQ,CAAE,CAClBY,KAAK,mBAAAV,MAAA,CAAmBE,KAAK,CAACJ,QAAQ,CAACG,IAAI,CAACuB,OAAO,EAAItB,KAAK,CAACJ,QAAQ,CAACG,IAAI,EAAI,cAAc,CAAE,CAAC,CACjG,CAAC,IAAM,IAAIC,KAAK,CAACuB,OAAO,CAAE,CACxBf,KAAK,CAAC,sDAAsD,CAAC,CAC/D,CAAC,IAAM,CACLA,KAAK,mBAAAV,MAAA,CAAmBE,KAAK,CAACsB,OAAO,CAAE,CAAC,CAC1C,CACF,CAEAjC,cAAc,CAAC,KAAK,CAAC,CACrBF,gBAAgB,CAAC,EAAE,CAAC,CACtB,CAAC,CAED,mBACEL,KAAA,QAAK0C,SAAS,CAAC,6BAA6B,CAAAC,QAAA,eAC1C7C,IAAA,OAAI4C,SAAS,CAAC,qCAAqC,CAAAC,QAAA,CAAC,yBAAuB,CAAI,CAAC,cAGhF3C,KAAA,QAAK0C,SAAS,CAAC,iDAAiD,CAAAC,QAAA,eAC9D7C,IAAA,OAAI4C,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,oBAAkB,CAAI,CAAC,cAClE7C,IAAA,UACEmC,IAAI,CAAC,MAAM,CACXW,MAAM,CAAC,SAAS,CAChBC,QAAQ,CAAEzB,gBAAiB,CAC3B0B,QAAQ,MACRJ,SAAS,CAAC,sCAAsC,CACjD,CAAC,cACF5C,IAAA,WACEiD,OAAO,CAAEvB,YAAa,CACtBwB,QAAQ,CAAE1C,WAAY,CACtBoC,SAAS,+CAAA1B,MAAA,CACPV,WAAW,CAAG,+BAA+B,CAAG,EAAE,CACjD,CAAAqC,QAAA,CAEFrC,WAAW,CAAG,cAAc,CAAG,eAAe,CACzC,CAAC,EACN,CAAC,cAGNN,KAAA,QAAK0C,SAAS,CAAC,MAAM,CAAAC,QAAA,eACnB7C,IAAA,OAAI4C,SAAS,CAAC,yCAAyC,CAAAC,QAAA,CAAC,eAAa,CAAI,CAAC,cAC1E7C,IAAA,QAAK4C,SAAS,CAAC,uCAAuC,CAAAC,QAAA,CACnDzC,MAAM,CAAC+C,GAAG,CAAC,CAACC,KAAK,CAAEC,KAAK,gBACvBrD,IAAA,QAEEsD,GAAG,IAAApC,MAAA,CAAKR,aAAa,EAAAQ,MAAA,CAAGkC,KAAK,CAAG,CAChCG,GAAG,CAAC,UAAU,CACdX,SAAS,CAAC,gBAAgB,EAHrBS,KAIN,CACF,CAAC,CACC,CAAC,EACH,CAAC,EACH,CAAC,CAEV,CAEA,cAAe,CAAAlD,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}